<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:cust="http://java.sun.com/jsf/composite/components">
<h:head>
    <script type="text/javascript" src="../resources/scripts/jquery142/jquery-1.4.2.js"></script>

    <cust:imports/>
    <cust:unittest/>

    <style type="text/css">
        @import "../styles/style.css";
    </style>
    <script type="text/javascript">
        if (!myfaces.config) {
            myfaces.config = {};
            //myfaces.config.transportAutoSelection = true;
            //myfaces.config.transportType = "xhrQueuedGet";

        }
        myfaces.config.projectStage = "Development";
    </script>
    <script type="text/javascript" src="../resources/scripts/testcases/doubleEvalDetection.js"></script>
</h:head>
<h:body>
    <h2>
        This script checks for a false eval by embedding an inline function
        once the lifecycle is finished an additional number should be added
        incremented by one
    </h2>
    <h:form id="testForm" prependId="true">
        <h:commandButton id="reloader" value="Reload panel">
            <f:ajax execute="@none" render="outputWriter"/>
        </h:commandButton>

        <script type="text/javascript">
            var counter = 0;
            function writeCounter() {
                document.getElementById('testForm:output').innerHTML += (counter++) + ' ';
            }
        </script>

        <h:panelGroup id="output" layout="block" style="width: 400px;
        height: 400px; border: 1px solid black;"/>

        <!--
        If this panelGroup contains only one script, it works well - the
script
        is evaluated only once - in runScripts() from jsf.js.
        But if it contains more script elements, the following code from
        jsf.js _outerHTMLCompliant() evaluates them first:
        item.parentNode.replaceChild(ret, item);
        And then runScripts() evaluates them also.
        -->
        <h:panelGroup id="outputWriter">
            <h:outputScript>
                writeCounter();
            </h:outputScript>

            <h:outputScript>var a;</h:outputScript>
        </h:panelGroup>


    </h:form>


</h:body>
</html>